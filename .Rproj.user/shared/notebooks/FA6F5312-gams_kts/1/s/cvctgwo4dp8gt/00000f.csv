"0","K <- 40"
"0","lambda <- c(10000, 1, 0.01, 0.00001)"
"0","N <- 300"
"0","newd <- with(gtemp, data.frame(Year = seq(min(Year), max(Year), length = N)))"
"0","fits <- lapply(lambda, function(lambda) gam(Temperature ~ s(Year, k = K, sp = lambda), data = gtemp))"
"0","pred <- vapply(fits, predict, numeric(N), newdata = newd)"
"0","op <- options(scipen = 100)"
"0","colnames(pred) <- lambda"
"0","newd <- cbind(newd, pred)"
"0","lambdaDat <- pivot_longer(newd, - Year, names_to =""Lambda"", values_to=""Fitted"")"
"0","lambdaDat <- transform(lambdaDat, Lambda = factor(paste(""lambda =="", as.character(Lambda)),"
"0","                                                  levels = paste(""lambda =="", as.character(lambda))))"
"0",""
"0","gtemp_plt + geom_line(data = lambdaDat, mapping = aes(x = Year, y = Fitted, group = Lambda),"
"0","                      size = 1, colour = ""#e66101"") +"
"0","    facet_wrap( ~ Lambda, ncol = 2, labeller = label_parsed)"
