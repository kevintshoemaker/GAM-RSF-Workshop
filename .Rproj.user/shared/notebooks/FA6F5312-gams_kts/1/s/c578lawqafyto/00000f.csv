"0","p <- c(1,3,8,15)"
"0","N <- 300"
"0","newd <- with(gtemp, data.frame(Year = seq(min(Year), max(Year), length = N)))"
"0","polyFun <- function(i, data = data) {"
"0","    lm(Temperature ~ poly(Year, degree = i), data = data)"
"0","}"
"0","mods <- lapply(p, polyFun, data = gtemp)"
"0","pred <- vapply(mods, predict, numeric(N), newdata = newd)"
"0","colnames(pred) <- p"
"0","newd <- cbind(newd, pred)"
"0","polyDat <- pivot_longer(newd, - Year, names_to=""Degree"", values_to=""Fitted"")"
"0","polyDat <- mutate(polyDat, Degree = ordered(Degree, levels = p))"
"0","gtemp_plt + geom_line(data = polyDat, mapping = aes(x = Year, y = Fitted, colour = Degree),"
"0","                      linewidth = 1.5, alpha = 0.9) +"
"0","    scale_color_brewer(name = ""Degree"", palette = ""PuOr"") +"
"0","    theme(legend.position = ""right"")"
